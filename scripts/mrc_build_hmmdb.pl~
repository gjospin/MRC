#!/usr/bin/perl -w

use strict;
use Getopt::Long;
use IPC::System::Simple qw(capture $EXITVAL);

#simply a wrapper for transeq at the moment

my( $input, $output, $ffdb, $hmmdb );
my $family_subset_list = "";
my $build_hmm_db = 0; #do we want to b

GetOptions(
    "i=s" => \$input,
    "o=s" => \$output,
    "d=s" => \$ffdb,
    "sub:s" => \$family_subset_list,
    "b"     => \$build_hmm_db, 
    "h=s"     => \$hmmdb, #name of hmmdb to use, if build, new hmmdb will be named this. We check for duplicate HMMdbs!
    );

my $hmmdb_path = $ffdb . "HMMdbs/" . $hmmdb;
#optionally build a hmmcompress db
if( $build_hmm_db ){
    if( -e $hmmdb_path ){
	my @time = localtime(time);
	my $unique_idx = join("", @time);
	$hmmdb_path = $hmmdb_path . "_" . $unique_idx;
	warn "A HMMdb with the name $hmmdb alread exists. Creating a new HMMdb at $hmmdb_path. If this is identical to currently existing HMMdb, you may elect to delete the new DB and rerun mrc_run_hmmscan.pl without the -b option\n";
	my @args = (
    }
}

my @args     = ("$input", "$output", "-frame=6");
my $results  = capture( "transeq " . "@args" );
if( $EXITVAL != 0 ){
    warn("Error translating sequences in $input: $results\n");
    exit(0);
}
